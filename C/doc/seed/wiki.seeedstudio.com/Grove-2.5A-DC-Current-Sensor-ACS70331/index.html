
<!DOCTYPE html>
<html lang="en" class="no-js">
  
<!-- Mirrored from wiki.seeedstudio.com/Grove-2.5A-DC-Current-Sensor-ACS70331/ by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 18 Apr 2019 20:55:24 GMT -->
<head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
        <meta name="description" content="Seeed Product Document">
      
      
        <link rel="canonical" href="index.html">
      
      
        <meta name="author" content="Bill">
      
      
        <link rel="shortcut icon" href="../https_/raw.githubusercontent.com/SeeedDocument/wiki_english/master/docs/images/favicon.html">
      
      <meta name="generator" content="mkdocs-0.17.3, mkdocs-material-1.7.4">
    
    
      
        <title>Grove-2.5A-DC-Current-Sensor-ACS70331 - Seeed Wiki</title>
      
    
    
      <script src="../assets/javascripts/modernizr-1df76c4e58.js"></script>
    
    
      <link rel="stylesheet" href="../assets/stylesheets/application-769c285a91.css">
      
        <link rel="stylesheet" href="../assets/stylesheets/application-02c2a4388f.palette.css">
      
    
    
      
        
        
        
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700|Roboto+Mono">
        <style>body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style>
      
      <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
    
    
    
  </head>
  
  
  
  
    <body data-md-color-primary="light-green" data-md-color-accent="indigo">
  
    <svg class="md-svg">
      <defs>
        
        
          <svg xmlns="http://www.w3.org/2000/svg" width="416" height="448" viewBox="0 0 416 448" id="github"><path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19T128 352t-18.125-8.5-10.75-19T96 304t3.125-20.5 10.75-19T128 256t18.125 8.5 10.75 19T160 304zm160 0q0 10-3.125 20.5t-10.75 19T288 352t-18.125-8.5-10.75-19T256 304t3.125-20.5 10.75-19T288 256t18.125 8.5 10.75 19T320 304zm40 0q0-30-17.25-51T296 232q-10.25 0-48.75 5.25Q229.5 240 208 240t-39.25-2.75Q130.75 232 120 232q-29.5 0-46.75 21T56 304q0 22 8 38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0 37.25-1.75t35-7.375 30.5-15 20.25-25.75T360 304zm56-44q0 51.75-15.25 82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5T212 416q-19.5 0-35.5-.75t-36.875-3.125-38.125-7.5-34.25-12.875T37 371.5t-21.5-28.75Q0 312 0 260q0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25 30.875Q171.5 96 212 96q37 0 70 8 26.25-20.5 46.75-30.25T376 64q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34 99.5z"/></svg>
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="drawer">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="search">
    <label class="md-overlay" data-md-component="overlay" for="drawer"></label>
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        
          <a href="../index.html" title="Seeed Wiki" class="md-logo md-header-nav__button">
            <img src="../images/favicon.ico" width="24" height="24">
          </a>
        
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <span class="md-flex__ellipsis md-header-nav__title">
          
            
              
                <span class="md-header-nav__parent">
                  Grove
                </span>
              
                <span class="md-header-nav__parent">
                  Sensor
                </span>
              
            
            Grove-2.5A-DC-Current-Sensor-ACS70331
          
        </span>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          <label class="md-icon md-icon--search md-header-nav__button" for="search"></label>
          
<div class="md-search" data-md-component="search">
  <label class="md-search__overlay" for="search"></label>
  <div class="md-search__inner">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" required placeholder="Search" accesskey="s" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query">
      <label class="md-icon md-search__icon" for="search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset">close</button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result" data-md-lang-search="">
          <div class="md-search-result__meta" data-md-lang-result-none="No matching documents" data-md-lang-result-one="1 matching document" data-md-lang-result-other="# matching documents">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
        
      </div>
      
        <div class="md-flex__cell md-flex__cell--shrink">
          <div class="md-header-nav__source">
            


  


  <a href="https://github.com/SeeedDocument/wiki_english/" title="Go to repository" class="md-source" data-md-source="github">
    
      <div class="md-source__icon">
        <svg viewBox="0 0 24 24" width="24" height="24">
          <use xlink:href="#github" width="24" height="24"></use>
        </svg>
      </div>
    
    <div class="md-source__repository">
      All Products
    </div>
  </a>

          </div>
        </div>
      
    </div>
  </nav>
</header>
    
    <div class="md-container">
      
      
      <main class="md-main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="drawer">
    
      <i class="md-logo md-nav__button">
        <img src="../images/favicon.ico">
      </i>
    
    Seeed Wiki
  </label>
  
    <div class="md-nav__source">
      


  


  <a href="https://github.com/SeeedDocument/wiki_english/" title="Go to repository" class="md-source" data-md-source="github">
    
      <div class="md-source__icon">
        <svg viewBox="0 0 24 24" width="24" height="24">
          <use xlink:href="#github" width="24" height="24"></use>
        </svg>
      </div>
    
    <div class="md-source__repository">
      All Products
    </div>
  </a>

    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href="../index.html" title="Seeed Wiki" class="md-nav__link">
      Seeed Wiki
    </a>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2" type="checkbox" id="nav-2" checked>
    
    <label class="md-nav__link" for="nav-2">
      Grove
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-2">
        Grove
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2-1" type="checkbox" id="nav-2-1" checked>
    
    <label class="md-nav__link" for="nav-2-1">
      Sensor
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-2-1">
        Sensor
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../Sensor/index.html" title="Sensor" class="md-nav__link">
      Sensor
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Grove-Light-Gesture-Color-Proximity_Sensor-TMG39931/index.html" title="Grove-Light-Gesture-Color-Proximity_Sensor-TMG39931" class="md-nav__link">
      Grove-Light-Gesture-Color-Proximity_Sensor-TMG39931
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Seeed_Relay_Page/index.html" title="Seeed_Relay_Page" class="md-nav__link">
      Seeed_Relay_Page
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Seeeduino_Lotus_Cortex-M0-/index.html" title="Seeeduino_Lotus_Cortex-M0-" class="md-nav__link">
      Seeeduino_Lotus_Cortex-M0-
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Grove-Triple_Color_E-Ink_Display_2_13/index.html" title="Grove-Triple_Color_E-Ink_Display_2_13" class="md-nav__link">
      Grove-Triple_Color_E-Ink_Display_2_13
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Grove_Beginner_Kit_for_Arduino/index.html" title="Grove_Beginner_Kit_for_Arduino" class="md-nav__link">
      Grove_Beginner_Kit_for_Arduino
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Grove_Beginner_Kit_for_Arduino_1/index.html" title="Grove_Beginner_Kit_for_Arduino_1" class="md-nav__link">
      Grove_Beginner_Kit_for_Arduino_1
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Grove-Triple_Color_E-Ink_Display_1_54/index.html" title="Grove-Triple_Color_E-Ink_Display_1_54" class="md-nav__link">
      Grove-Triple_Color_E-Ink_Display_1_54
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Arch_Mix/index.html" title="Arch Mix" class="md-nav__link">
      Arch Mix
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Arch_Mix_CN/index.html" title="Arch_Mix_CN" class="md-nav__link">
      Arch_Mix_CN
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Grove-CO2_Temperature_Humidity_Sensor-SCD30/index.html" title="Grove-CO2_Temperature_Humidity_Sensor-SCD30" class="md-nav__link">
      Grove-CO2_Temperature_Humidity_Sensor-SCD30
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Grove-Optocoupler_Relay-M281/index.html" title="Grove-Optocoupler_Relay-M281" class="md-nav__link">
      Grove-Optocoupler_Relay-M281
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Grove-RS485/index.html" title="Grove-RS485" class="md-nav__link">
      Grove-RS485
    </a>
  </li>

        
          
          
          

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="toc">
    
    
      <label class="md-nav__link md-nav__link--active" for="toc">
        Grove-2.5A-DC-Current-Sensor-ACS70331
      </label>
    
    <a href="index.html" title="Grove-2.5A-DC-Current-Sensor-ACS70331" class="md-nav__link md-nav__link--active">
      Grove-2.5A-DC-Current-Sensor-ACS70331
    </a>
    
      
<nav class="md-nav md-nav--secondary">
  
  
  
    <label class="md-nav__title" for="toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#feature" title="Feature" class="md-nav__link">
    Feature
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#specification" title="Specification" class="md-nav__link">
    Specification
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#working-principle" title="Working Principle" class="md-nav__link">
    Working Principle
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hardware-overview" title="Hardware Overview" class="md-nav__link">
    Hardware Overview
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#platforms-supported" title="Platforms Supported" class="md-nav__link">
    Platforms Supported
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#getting-started" title="Getting Started" class="md-nav__link">
    Getting Started
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#play-with-arduino" title="Play With Arduino" class="md-nav__link">
    Play With Arduino
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#hardware-connection" title="Hardware Connection" class="md-nav__link">
    Hardware Connection
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#software" title="Software" class="md-nav__link">
    Software
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#play-with-raspberry" title="Play with Raspberry" class="md-nav__link">
    Play with Raspberry
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#hardware-connection_1" title="Hardware Connection" class="md-nav__link">
    Hardware Connection
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#software_1" title="Software" class="md-nav__link">
    Software
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#faq" title="FAQ" class="md-nav__link">
    FAQ
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#resources" title="Resources" class="md-nav__link">
    Resources
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#tech-support" title="Tech Support" class="md-nav__link">
    Tech Support
  </a>
  
</li>
      
      
      

    
    <br />
    <br />

    <td align="left"><a href="https://www.seeedstudio.com/SeeedStudio-BeagleBone-Green-p-2504.html" target="_blank"><img alt="" src="https://github.com/SeeedDocument/wiki_english/raw/master/docs/images/BBG_banner.png" /></a></td>
  

    </ul>
  
</nav>
    
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Grove-5A_DC_AC_Current_Sensor-ACS70331/index.html" title="Grove-5A_DC_AC_Current_Sensor-ACS70331" class="md-nav__link">
      Grove-5A_DC_AC_Current_Sensor-ACS70331
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Grove-10A_DC_Current_Sensor-ACS725/index.html" title="Grove-10A_DC_Current_Sensor-ACS725" class="md-nav__link">
      Grove-10A_DC_Current_Sensor-ACS725
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
  
    <label class="md-nav__title" for="toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#feature" title="Feature" class="md-nav__link">
    Feature
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#specification" title="Specification" class="md-nav__link">
    Specification
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#working-principle" title="Working Principle" class="md-nav__link">
    Working Principle
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hardware-overview" title="Hardware Overview" class="md-nav__link">
    Hardware Overview
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#platforms-supported" title="Platforms Supported" class="md-nav__link">
    Platforms Supported
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#getting-started" title="Getting Started" class="md-nav__link">
    Getting Started
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#play-with-arduino" title="Play With Arduino" class="md-nav__link">
    Play With Arduino
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#hardware-connection" title="Hardware Connection" class="md-nav__link">
    Hardware Connection
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#software" title="Software" class="md-nav__link">
    Software
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#play-with-raspberry" title="Play with Raspberry" class="md-nav__link">
    Play with Raspberry
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#hardware-connection_1" title="Hardware Connection" class="md-nav__link">
    Hardware Connection
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#software_1" title="Software" class="md-nav__link">
    Software
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#faq" title="FAQ" class="md-nav__link">
    FAQ
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#resources" title="Resources" class="md-nav__link">
    Resources
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#tech-support" title="Tech Support" class="md-nav__link">
    Tech Support
  </a>
  
</li>
      
      
      

    
    <br />
    <br />

    <td align="left"><a href="https://www.seeedstudio.com/SeeedStudio-BeagleBone-Green-p-2504.html" target="_blank"><img alt="" src="https://github.com/SeeedDocument/wiki_english/raw/master/docs/images/BBG_banner.png" /></a></td>
  

    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/SeeedDocument/wiki_english/blob/master/docs/Grove-2.5A-DC-Current-Sensor-ACS70331.md" title="Edit this page" class="md-icon md-content__icon">edit</a>
                
                
                  <h1>Grove-2.5A-DC-Current-Sensor-ACS70331</h1>
                
                <p><img alt="" src="https://github.com/SeeedDocument/Grove-2.5A_DC_Current_Sensor-ACS70331/raw/master/img/preview.png" /></p>
<p>The Grove - 2.5A DC Current Sensor(ACS70331) is a high precision DC current sensor based on ACS70331. The ACS70331 is a chip series, this module uses ACS70331EESATR-2P5U3, which is Allegro’s high sensitivity,current sensor IC for &lt;2.5 A current sensing applications. It incorporates giant magneto-resistive (GMR) technology that is 25 times more sensitive than traditional Hall-effect sensors to sense the magnetic field generated by the current flowing through the low resistance, integrated primary conductor.   </p>
<p>The Grove - 2.5A DC Current Sensor(ACS70331) can measure the DC current up to 2.5A and has a base sensitivity of 800mV/A. This sensor do not support AC current, if you want to measure the AC load please check the:</p>
<p><a href="https://www.seeedstudio.com/Grove-5A-DC-AC-Current-Sensor-ACS70331-p-2928.html">Grove - ±5A DC/AC Current Sensor (ACS70331)</a>    </p>
<p style="text-align:center"><a href="https://www.seeedstudio.com/Grove-2-5A-DC-Current-Sensor-ACS70331-p-2929.html" target="_blank"><img src="https://github.com/SeeedDocument/wiki_english/raw/master/docs/images/300px-Get_One_Now_Banner-ragular.png" /></a></p>

<h2 id="feature">Feature<a class="headerlink" href="#feature" title="Permanent link">&para;</a></h2>
<ul>
<li>1 MHz bandwidth with response time &lt;550 ns</li>
<li>Low noise: 8 mA(rms) at 1 MHz</li>
<li>1.1 mΩ primary conductor resistance results in low power loss</li>
<li>High DC PSRR enables use with low accuracy power supplies or batteries (3 to 4.5 V operation)</li>
<li>Analog output</li>
</ul>
<h2 id="specification">Specification<a class="headerlink" href="#specification" title="Permanent link">&para;</a></h2>
<table>
<thead>
<tr>
<th>Parameter</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td>Supply voltage</td>
<td>3.3V / 5V</td>
</tr>
<tr>
<td>Operating ambient temperature</td>
<td>-40 – 85℃</td>
</tr>
<tr>
<td>Storage temperature</td>
<td>- 65°C – 125°C</td>
</tr>
<tr>
<td>Working Voltage</td>
<td>&lt;100V</td>
</tr>
<tr>
<td>Current sensing range</td>
<td>0 – 2.5A</td>
</tr>
<tr>
<td>Sensitivity</td>
<td>800mV/A(Typ.)</td>
</tr>
<tr>
<td>Output interface</td>
<td>Analog</td>
</tr>
<tr>
<td>Input interface</td>
<td>Screw terminal</td>
</tr>
</tbody>
</table>
<h2 id="working-principle">Working Principle<a class="headerlink" href="#working-principle" title="Permanent link">&para;</a></h2>
<p>There are two types of current sensing: direct and indirect. Classification is mainly based on the technology used to measure current.</p>
<p><strong>Direct sensing:</strong></p>
<ul>
<li>Ohm's Law</li>
</ul>
<p><strong>Indirect seneing:</strong> </p>
<ul>
<li>Faraday's Law of Induction</li>
<li>Magnetic field sensors</li>
<li>Faraday Effect</li>
</ul>
<p>The Grove - 2.5A DC Current Sensor(ACS70331) uses magnetic field sensors technology. And there are three kinds of Magnetic field sensors technology:</p>
<ul>
<li>Hall effect</li>
<li>Flux gate sensors</li>
<li>Magneto-resistive current sensor</li>
</ul>
<p>The Grove - 2.5A DC Current Sensor(ACS70331) is based on the Magneto-resistive current sensor priciple, which is also known as GMR. A magneto-resistor (MR) is a two terminal device which changes its resistance parabolically with applied magnetic field. This variation of the resistance of MR due to the magnetic field is known as the Magnetoresistive Effect.</p>
<p>The internal construction of the ACS70331 QFN package is shown in Figure 2. The die sits above the primary current path such that magnetic field is produced in plane with the GMR elements on the die. GMR elements 1 and 2 sense field in the +X direction for positive IP current flow, and GMR elements 3 and 4 sense field in the –X direction for positive IP current flow. This enables differential measurement of the current and rejection of external stray fields.</p>
<div align="center">
<figure>
  <p style="text-align:center"><a href="https://github.com/SeeedDocument/Grove-2.5A_DC_Current_Sensor-ACS70331/raw/master/img/principle1.jpg" target="_blank"><img src="https://github.com/SeeedDocument/Grove-2.5A_DC_Current_Sensor-ACS70331/raw/master/img/principle1.jpg" /></a></p>
  <figcaption><b>Figure 1</b>. <i>ACS70331 Internal Construction</i></figcaption>
</figure>
</div>

<p>The four GMR elements are arranged in a Wheatstone bridge configuration as shown in Figure 2 such that the output of the bridge is proportional to the differential field sensed by the four elements, rejecting common fields.</p>
<div align="center">
<figure>
  <p style="text-align:center"><a href="https://github.com/SeeedDocument/Grove-2.5A_DC_Current_Sensor-ACS70331/raw/master/img/principle2.jpg" target="_blank"><img src="https://github.com/SeeedDocument/Grove-2.5A_DC_Current_Sensor-ACS70331/raw/master/img/principle2.jpg" /></a></p>
  <figcaption><b>Figure 2</b>. <i>Wheatstone Bridge Configuration</i></figcaption>
</figure>
</div>

<h2 id="hardware-overview">Hardware Overview<a class="headerlink" href="#hardware-overview" title="Permanent link">&para;</a></h2>
<div align="center">
<figure>
  <p style="text-align:center"><a href="https://github.com/SeeedDocument/Grove-2.5A_DC_Current_Sensor-ACS70331/raw/master/img/pinout.jpg" target="_blank"><img src="https://github.com/SeeedDocument/Grove-2.5A_DC_Current_Sensor-ACS70331/raw/master/img/pinout.jpg" /></a></p>
  <figcaption><b>Figure 3</b>. <i>Pinout</i></figcaption>
</figure>
</div>

<h2 id="platforms-supported">Platforms Supported<a class="headerlink" href="#platforms-supported" title="Permanent link">&para;</a></h2>
<table>
<thead>
<tr>
<th>Arduino</th>
<th>Raspberry Pi</th>
<th>BeagleBone</th>
<th>Wio</th>
<th>LinkIt ONE</th>
</tr>
</thead>
<tbody>
<tr>
<td><img alt="" src="https://raw.githubusercontent.com/SeeedDocument/wiki_english/master/docs/images/arduino_logo.jpg" /></td>
<td><img alt="" src="https://raw.githubusercontent.com/SeeedDocument/wiki_english/master/docs/images/raspberry_pi_logo.jpg" /></td>
<td><img alt="" src="https://raw.githubusercontent.com/SeeedDocument/wiki_english/master/docs/images/bbg_logo_n.jpg" /></td>
<td><img alt="" src="https://raw.githubusercontent.com/SeeedDocument/wiki_english/master/docs/images/wio_logo_n.jpg" /></td>
<td><img alt="" src="https://raw.githubusercontent.com/SeeedDocument/wiki_english/master/docs/images/linkit_logo_n.jpg" /></td>
</tr>
</tbody>
</table>
<h2 id="getting-started">Getting Started<a class="headerlink" href="#getting-started" title="Permanent link">&para;</a></h2>
<div class="admonition danger">
<p class="admonition-title">Danger<p>The human body is forbidden to touch the module during the test, otherwise there is danger of electric shock.</p>
</p>
</div>
<h3 id="play-with-arduino">Play With Arduino<a class="headerlink" href="#play-with-arduino" title="Permanent link">&para;</a></h3>
<p><strong>Materials required</strong></p>
<table>
<thead>
<tr>
<th>Seeeduino V4.2</th>
<th>Base Shield</th>
<th>2.5A DC Current Sensor(ACS70331)</th>
</tr>
</thead>
<tbody>
<tr>
<td><img alt="enter image description here" src="https://github.com/SeeedDocument/wiki_english/raw/master/docs/images/seeeduino_v4.2.jpg" /></td>
<td><img alt="enter image description here" src="https://github.com/SeeedDocument/wiki_english/raw/master/docs/images/base_shield.jpg" /></td>
<td><img alt="enter image description here" src="https://github.com/SeeedDocument/Grove-2.5A_DC_Current_Sensor-ACS70331/raw/master/img/thumbnail.jpg" /></td>
</tr>
<tr>
<td><a href="http://www.seeedstudio.com/Seeeduino-V4.2-p-2517.html">Get ONE Now</a></td>
<td><a href="https://www.seeedstudio.com/Base-Shield-V2-p-1378.html">Get ONE Now</a></td>
<td><a href="https://www.seeedstudio.com/Grove-2-5A-DC-Current-Sensor-ACS70331-p-2929.html">Get ONE Now</a></td>
</tr>
</tbody>
</table>
<blockquote>
<p>In addition, you can consider our new <a href="https://www.seeedstudio.com/Seeeduino-Lotus-Cortex-M0-p-2896.html">Seeeduino Lotus M0+</a>, which is equivalent to the combination of Seeeduino V4.2 and Baseshield.</p>
</blockquote>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><strong>1</strong> Please plug the USB cable gently, otherwise you may damage the port. Please use the USB cable with 4 wires inside, the 2 wires cable can't transfer data. If you are not sure about the wire you have, you can click <a href="https://www.seeedstudio.com/Micro-USB-Cable-48cm-p-1475.html">here</a> to buy </p>
<p><strong>2</strong> Each Grove module comes with a Grove cable when you buy. In case you lose the Grove cable, you can click <a href="https://www.seeedstudio.com/Grove-Universal-4-Pin-Buckled-20cm-Cable-(5-PCs-pack)-p-936.html">here</a> to buy.</p>
</div>
<h4 id="hardware-connection">Hardware Connection<a class="headerlink" href="#hardware-connection" title="Permanent link">&para;</a></h4>
<ul>
<li>
<p><strong>Step 1.</strong> Connect the Grove - 2.5A DC Current Sensor(ACS70331) to the <strong>A0</strong> port of the Base Shield.</p>
</li>
<li>
<p><strong>Step 2.</strong> Connect the positive and negative poles of the circuit to be tested to the corresponding positive and negative poles of the screw terminal.</p>
</li>
</ul>
<div class="admonition tip">
<p class="admonition-title">Tip<p>If you reverse the positive and negative poles, the reading will be reversed. This sensor need calibration before use, so please do not power on the circuit first.</p>
</p>
</div>
<ul>
<li>
<p><strong>Step 3.</strong> Plug Grove - Base Shield into Seeeduino.</p>
</li>
<li>
<p><strong>Step 4.</strong> Connect Seeeduino to PC via a USB cable.</p>
</li>
</ul>
<div align="center">
<figure>
  <p style="text-align:center"><a href="https://github.com/SeeedDocument/Grove-2.5A_DC_Current_Sensor-ACS70331/raw/master/img/103020193-connect.png" target="_blank"><img src="https://github.com/SeeedDocument/Grove-2.5A_DC_Current_Sensor-ACS70331/raw/master/img/103020193-connect.png" /></a></p>
  <figcaption><b>Figure 4</b>. <i>We use the DC Power Supply in this demo, please set the current to 0A or do not power on it at first</i></figcaption>
</figure>
</div>

<h4 id="software">Software<a class="headerlink" href="#software" title="Permanent link">&para;</a></h4>
<div class="admonition attention">
<p class="admonition-title">Attention<p>If this is the first time you work with Arduino, we strongly recommend you to see <a href="../Getting_Started_with_Arduino/index.html">Getting Started with Arduino</a> before the start.</p>
</p>
</div>
<ul>
<li>
<p><strong>Step 1.</strong> Download the <a href="https://github.com/Seeed-Studio/Grove_Current_Sensor">Grove Current Sensor</a> Library from Github.</p>
</li>
<li>
<p><strong>Step 2.</strong> In the /example/ folder, you can find the demo code. Here we take the <strong>Grove_2_5A_Current_Sensor.ino</strong> for instance. Just click the Grove_2_5A_Current_Sensor.ino to open the demo. Or you can copy the following code:</p>
</li>
</ul>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="cp">#ifdef ARDUINO_SAMD_VARIANT_COMPLIANCE</span>
  <span class="cp">#define RefVal 3.3</span>
  <span class="cp">#define SERIAL SerialUSB</span>
<span class="cp">#else</span>
  <span class="cp">#define RefVal 5.0</span>
  <span class="cp">#define SERIAL Serial</span>
<span class="cp">#endif</span>
<span class="c1">//An OLED Display is required here</span>
<span class="c1">//use pin A0</span>
<span class="cp">#define Pin A0</span>

<span class="c1">// Take the average of 10 times</span>

<span class="k">const</span> <span class="kt">int</span> <span class="n">averageValue</span> <span class="o">=</span> <span class="mi">10</span><span class="p">;</span>

<span class="kt">int</span> <span class="n">sensorValue</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>

<span class="kt">float</span> <span class="n">sensitivity</span> <span class="o">=</span> <span class="mf">1000.0</span> <span class="o">/</span> <span class="mf">800.0</span><span class="p">;</span> <span class="c1">//1000mA per 800mV </span>


<span class="kt">float</span> <span class="n">Vref</span> <span class="o">=</span> <span class="mi">265</span><span class="p">;</span>  <span class="c1">//Firstly,change this!!!</span>

<span class="kt">void</span> <span class="nf">setup</span><span class="p">()</span> 
<span class="p">{</span>
  <span class="n">SERIAL</span><span class="p">.</span><span class="n">begin</span><span class="p">(</span><span class="mi">9600</span><span class="p">);</span>
<span class="p">}</span>

<span class="kt">void</span> <span class="nf">loop</span><span class="p">()</span> 
<span class="p">{</span>
  <span class="c1">// Read the value 10 times:</span>
  <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">averageValue</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span>
  <span class="p">{</span>
    <span class="n">sensorValue</span> <span class="o">+=</span> <span class="n">analogRead</span><span class="p">(</span><span class="n">Pin</span><span class="p">);</span>

    <span class="c1">// wait 2 milliseconds before the next loop</span>
    <span class="n">delay</span><span class="p">(</span><span class="mi">2</span><span class="p">);</span>

  <span class="p">}</span>

  <span class="n">sensorValue</span> <span class="o">=</span> <span class="n">sensorValue</span> <span class="o">/</span> <span class="n">averageValue</span><span class="p">;</span>


  <span class="c1">// The on-board ADC is 10-bits </span>
  <span class="c1">// Different power supply will lead to different reference sources</span>
  <span class="c1">// example: 2^10 = 1024 -&gt; 5V / 1024 ~= 4.88mV</span>
  <span class="c1">//          unitValue= 5.0 / 1024.0*1000 ;</span>
  <span class="kt">float</span> <span class="n">unitValue</span><span class="o">=</span> <span class="n">RefVal</span> <span class="o">/</span> <span class="mf">1024.0</span><span class="o">*</span><span class="mi">1000</span> <span class="p">;</span>
  <span class="kt">float</span> <span class="n">voltage</span> <span class="o">=</span> <span class="n">unitValue</span> <span class="o">*</span> <span class="n">sensorValue</span><span class="p">;</span> 

  <span class="c1">//When no load,Vref=initialValue</span>
  <span class="n">SERIAL</span><span class="p">.</span><span class="n">print</span><span class="p">(</span><span class="s">&quot;initialValue: &quot;</span><span class="p">);</span>
  <span class="n">SERIAL</span><span class="p">.</span><span class="n">print</span><span class="p">(</span><span class="n">voltage</span><span class="p">);</span>
  <span class="n">SERIAL</span><span class="p">.</span><span class="n">println</span><span class="p">(</span><span class="s">&quot;mV&quot;</span><span class="p">);</span> 

  <span class="c1">// Calculate the corresponding current</span>
  <span class="kt">float</span> <span class="n">current</span> <span class="o">=</span> <span class="p">(</span><span class="n">voltage</span> <span class="o">-</span> <span class="n">Vref</span><span class="p">)</span> <span class="o">*</span> <span class="n">sensitivity</span><span class="p">;</span>

  <span class="c1">// Print display voltage (mV)</span>
  <span class="c1">// This voltage is the pin voltage corresponding to the current</span>
  <span class="cm">/*</span>
<span class="cm">  voltage = unitValue * sensorValue-Vref;</span>
<span class="cm">  SERIAL.print(voltage);</span>
<span class="cm">  SERIAL.println(&quot;mV&quot;);</span>
<span class="cm">  */</span>

  <span class="c1">// Print display current (mA)</span>
  <span class="n">SERIAL</span><span class="p">.</span><span class="n">print</span><span class="p">(</span><span class="n">current</span><span class="p">);</span>
  <span class="n">SERIAL</span><span class="p">.</span><span class="n">println</span><span class="p">(</span><span class="s">&quot;mA&quot;</span><span class="p">);</span>

  <span class="n">SERIAL</span><span class="p">.</span><span class="n">print</span><span class="p">(</span><span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>

  <span class="c1">// Reset the sensorValue for the next reading</span>
  <span class="n">sensorValue</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
  <span class="c1">// Read it once per second</span>
  <span class="n">delay</span><span class="p">(</span><span class="mi">1000</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</td></tr></table>

<ul>
<li>
<p><strong>Step 3.</strong> Upload the demo. If you do not know how to upload the code, please check <a href="../Upload_Code/index.html">How to upload code</a>.</p>
</li>
<li>
<p><strong>Step 4.</strong> Open the <strong>Serial Monitor</strong> of Arduino IDE by click <strong>Tool-&gt; Serial Monitor</strong>. Or tap the <span class="keys"><kbd class="key-control">Ctrl</kbd><span>+</span><kbd class="key-shift">Shift</kbd><span>+</span><kbd class="key-m">M</kbd></span> key at the same time. Set the baud rate to <strong>9600</strong>.</p>
</li>
<li>
<p><strong>Step 5. Calibration</strong><br />
        When there is no current flowing, the sensor will still have a small output value. We call this value <strong>zero offset</strong>. </p>
</li>
</ul>
<div align="center">
<figure>
  <p style="text-align:center"><a href="https://github.com/SeeedDocument/Grove-2.5A_DC_Current_Sensor-ACS70331/raw/master/img/ca.jpg" target="_blank"><img src="https://github.com/SeeedDocument/Grove-2.5A_DC_Current_Sensor-ACS70331/raw/master/img/ca.jpg" /></a></p>
  <figcaption><b>Figure 5</b>. <i>The zero offset of this board is 283.20mV，Converted into current is 22.75mA</i></figcaption>
</figure>
</div>

<p>Due to the presence of zero offset, the sensor will also have a reading when there is no current. So we set a parameter <strong>Vref</strong> to fix it, you can find it in the code block above.</p>
<p>Line 21:
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="kt">float</span> <span class="n">Vref</span> <span class="o">=</span> <span class="mi">265</span><span class="p">;</span>  
<span class="c1">//Vref is zero drift value, you need to change this value to the value you actually measured before using it.</span>
</pre></div>
</td></tr></table></p>
<p>In the demo code, we set the Vref to 265, however, the zero offset value varies from board to board. As you know, the board we use in this demo is 288.09. So let's modify the Line 21:</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="kt">float</span> <span class="n">Vref</span> <span class="o">=</span> <span class="mf">283.20</span><span class="p">;</span>
</pre></div>
</td></tr></table>

<p>Then save the code and upload the code again, follow the Step 2. and Step 3. Now let's see：</p>
<div align="center">
<figure>
  <p style="text-align:center"><a href="https://github.com/SeeedDocument/Grove-2.5A_DC_Current_Sensor-ACS70331/raw/master/img/afca.jpg" target="_blank"><img src="https://github.com/SeeedDocument/Grove-2.5A_DC_Current_Sensor-ACS70331/raw/master/img/afca.jpg" /></a></p>
  <figcaption><b>Figure 6</b>. <i>Now the current zero offset turns to 0mA</i></figcaption>
</figure>
</div>

<p>When the current output becomes to 0mA or a small value, you have completed the calibration.</p>
<ul>
<li><strong>Step 5.</strong> Now it's all yours, you can power up the current. Please feel free to use it, remember this is a 2.5A DC Current Sensor, current cannot exceed 2.5A!  </li>
</ul>
<p>If you want to know the calculation formula of the result, please refer to the <a href="#faq">FAQ Q1</a></p>
<h3 id="play-with-raspberry">Play with Raspberry<a class="headerlink" href="#play-with-raspberry" title="Permanent link">&para;</a></h3>
<p><strong>Materials required</strong></p>
<table>
<thead>
<tr>
<th>Raspberry pi</th>
<th>Grove Base Hat for RasPi</th>
<th>2.5A DC Current Sensor</th>
</tr>
</thead>
<tbody>
<tr>
<td><img alt="enter image description here" src="https://github.com/SeeedDocument/wiki_english/raw/master/docs/images/rasp.jpg" /></td>
<td><img alt="enter image description here" src="https://github.com/SeeedDocument/Grove_Base_Hat_for_Raspberry_Pi/raw/master/img/thumbnail.jpg" /></td>
<td><img alt="enter image description here" src="https://github.com/SeeedDocument/Grove-2.5A_DC_Current_Sensor-ACS70331/raw/master/img/thumbnail.jpg" /></td>
</tr>
<tr>
<td><a href="https://www.seeedstudio.com/Raspberry-Pi-3-Model-B-p-2625.html">Get ONE Now</a></td>
<td><a href="https://www.seeedstudio.com/Grove-Base-Hat-for-Raspberry-Pi-p-3186.html">Get ONE Now</a></td>
<td><a href="https://www.seeedstudio.com/Grove-2-5A-DC-Current-Sensor-ACS70331-p-2929.html">Get ONE Now</a></td>
</tr>
</tbody>
</table>
<h4 id="hardware-connection_1">Hardware Connection<a class="headerlink" href="#hardware-connection_1" title="Permanent link">&para;</a></h4>
<ul>
<li>
<p><strong>Step 1</strong>. Plug the Grove Base Hat into Raspberry Pi.</p>
</li>
<li>
<p><strong>Step 2</strong>. Connect the Grove - 2.5A DC Current Sensor(ACS70331) to port <strong>A0</strong> of the Base Hat.</p>
</li>
<li>
<p><strong>Step 3</strong>. Connect the positive and negative poles of the circuit to be tested to the corresponding positive and negative poles of the screw terminal.</p>
</li>
</ul>
<div align="center">
<figure>
  <p style="text-align:center"><a href="https://github.com/SeeedDocument/Grove-2.5A_DC_Current_Sensor-ACS70331/raw/master/img/103020193-connect_pi.png" target="_blank"><img src="https://github.com/SeeedDocument/Grove-2.5A_DC_Current_Sensor-ACS70331/raw/master/img/103020193-connect_pi.png" /></a></p>
  <figcaption><b>Figure 7</b>. <i>We use the DC Power Supply in this demo, please set the current to 0A or do not power on it at first</i></figcaption>
</figure>
</div>

<div class="admonition tip">
<p class="admonition-title">Tip<p>If you reverse the positive and negative poles, the reading will be reversed. This sensor need calibration before use, so please do not power on the circuit first.</p>
</p>
</div>
<ul>
<li><strong>Step 4</strong>. Power the Raspberry Pi via the Micro-USB cable.</li>
</ul>
<div class="admonition attenton">
<p class="admonition-title">Attenton<p>You can power the Raspberry Pi by computer USB port or DC adapter, however, if you are using the Raspberry pi 3B+, we strongly recommend you to power it by DC adapter, if you use the USB port of the PC, you may damage the Raspberry Pi 3B+.</p>
</p>
</div>
<h4 id="software_1">Software<a class="headerlink" href="#software_1" title="Permanent link">&para;</a></h4>
<ul>
<li>
<p><strong>Step 1</strong>. Follow <a href="../Grove_Base_Hat_for_Raspberry_Pi/index.html#installation">Setting Software</a> to configure the development environment.</p>
</li>
<li>
<p><strong>Step 2</strong>. Download the source file by cloning the <a href="https://github.com/Seeed-Studio/grove.py">grove.py</a> library. </p>
</li>
</ul>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2</pre></div></td><td class="code"><div class="codehilite"><pre><span></span>cd ~
git clone https://github.com/Seeed-Studio/grove.py
</pre></div>
</td></tr></table>

<ul>
<li><strong>Step 3</strong>. Excute following commands to run the code.</li>
</ul>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="n">cd</span> <span class="n">grove</span><span class="o">.</span><span class="n">py</span><span class="o">/</span><span class="n">grove</span>   <span class="c1"># to enter the demo file folder</span>
<span class="n">python</span> <span class="n">grove_current_sensor</span><span class="o">.</span><span class="n">py</span> <span class="mi">0</span> <span class="mf">2.5</span><span class="n">A</span>   <span class="c1"># to run the demo program </span>
</pre></div>
</td></tr></table>

<p>Then the terminal will output as following:</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="n">pi</span><span class="nd">@raspberrypi</span><span class="p">:</span><span class="o">~/</span><span class="n">grove</span><span class="o">.</span><span class="n">py</span><span class="o">/</span><span class="n">grove</span> <span class="err">$</span> <span class="n">python</span> <span class="n">grove_current_sensor</span><span class="o">.</span><span class="n">py</span> <span class="mi">0</span> <span class="mf">2.5</span><span class="n">A</span>
<span class="n">pin_voltage</span><span class="p">(</span><span class="n">mV</span><span class="p">):</span>
<span class="mi">270</span>
<span class="n">current</span><span class="p">(</span><span class="n">mA</span><span class="p">):</span>
<span class="mf">13.0</span>
<span class="p">()</span>
<span class="n">pin_voltage</span><span class="p">(</span><span class="n">mV</span><span class="p">):</span>
<span class="mi">270</span>
<span class="n">current</span><span class="p">(</span><span class="n">mA</span><span class="p">):</span>
<span class="mf">13.0</span>
<span class="p">()</span>
<span class="n">pin_voltage</span><span class="p">(</span><span class="n">mV</span><span class="p">):</span>
<span class="mi">270</span>
<span class="n">current</span><span class="p">(</span><span class="n">mA</span><span class="p">):</span>
<span class="mf">13.0</span>
<span class="p">()</span>
<span class="n">pin_voltage</span><span class="p">(</span><span class="n">mV</span><span class="p">):</span>
<span class="mi">269</span>
<span class="n">current</span><span class="p">(</span><span class="n">mA</span><span class="p">):</span>
<span class="mf">11.0</span>
<span class="p">()</span>
<span class="n">pin_voltage</span><span class="p">(</span><span class="n">mV</span><span class="p">):</span>
<span class="mi">270</span>
<span class="n">current</span><span class="p">(</span><span class="n">mA</span><span class="p">):</span>
<span class="mf">13.0</span>
<span class="p">()</span>
<span class="o">^</span><span class="n">CTraceback</span> <span class="p">(</span><span class="n">most</span> <span class="n">recent</span> <span class="n">call</span> <span class="n">last</span><span class="p">):</span>
  <span class="n">File</span> <span class="s2">&quot;grove_current_sensor.py&quot;</span><span class="p">,</span> <span class="n">line</span> <span class="mi">200</span><span class="p">,</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
    <span class="n">main</span><span class="p">()</span>
  <span class="n">File</span> <span class="s2">&quot;grove_current_sensor.py&quot;</span><span class="p">,</span> <span class="n">line</span> <span class="mi">185</span><span class="p">,</span> <span class="ow">in</span> <span class="n">main</span>
    <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="ne">KeyboardInterrupt</span>
</pre></div>
</td></tr></table>

<p>Tap <span class="keys"><kbd class="key-control">Ctrl</kbd><span>+</span><kbd class="key-c">C</kbd></span> to quit.</p>
<div class="admonition note">
<p class="admonition-title">Note<p>Please note the second command, There are two parameters after the file name:   </p>
<ul>
<li>
<p><font style="font-weight:bold;color:#AE0000">0</font> means the sensor is connected to port A0. If you connect the sensor to port A2, then you need to change this parameter to 2.  This parameter has a range of 0-7, but if you use the Grove base hat, you can only use 0/2/4/6 because of the physical limitations of the interface.  </p>
</li>
<li>
<p><font style="font-weight:bold;color:#AE0000">2.5A</font> means the current sensor type is 2.5A DC </p>
</li>
</ul>
</p>
</div>
<table>
<thead>
<tr>
<th>Sensor</th>
<th>Current type</th>
<th>Parameter Value</th>
</tr>
</thead>
<tbody>
<tr>
<td>Grove - 2.5A DC Current Sensor(ACS70331)</td>
<td>DC</td>
<td>2.5A</td>
</tr>
<tr>
<td>Grove - ±5A DC/AC Current Sensor (ACS70331)</td>
<td>DC</td>
<td>5A_DC</td>
</tr>
<tr>
<td></td>
<td>AC</td>
<td>5A_AC</td>
</tr>
<tr>
<td>Grove - 10A DC Current Sensor (ACS725)</td>
<td>DC</td>
<td>10A</td>
</tr>
</tbody>
</table>
<div align="center"><i>This series has three current sensors, the parameter list is as above</i></div>

<ul>
<li>
<p><strong>Step 4 Calibration</strong>.  </p>
<p>When there is no current flowing, the sensor will still have a small output value. We call this value zero offset. As you can see, in the step 3, the zero offset of this board is 270mV, converted into current is 13mA.</p>
<p>Due to the presence of zero offset, the sensor will also have a reading when there is no current. So we set a parameter <strong>Vref</strong> to fix it, you can find it in the <strong>python grove_current_sensor.py</strong>. For the Grove - 2.5A DC Current Sensor(ACS70331), we set the <strong>Vref</strong> to 260 by default, however the zero offset varies from board to board. That's why we need to do the calibration first.</p>
<p>Check the python code below：</p>
</li>
</ul>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>  1
  2
  3
  4
  5
  6
  7
  8
  9
 10
 11
 12
 13
 14
 15
 16
 17
 18
 19
 20
 21
 22
 23
 24
 25
 26
 27
 28
 29
 30
 31
 32
 33
 34
 35
 36
 37
 38
 39
 40
 41
 42
 43
 44
 45
 46
 47
 48
 49
 50
 51
 52
 53
 54
 55
 56
 57
 58
 59
 60
 61
 62
 63
 64
 65
 66
 67
 68
 69
 70
 71
 72
 73
 74
 75
 76
 77
 78
 79
 80
 81
 82
 83
 84
 85
 86
 87
 88
 89
 90
 91
 92
 93
 94
 95
 96
 97
 98
 99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181
182
183
184
185
186
187
188
189
190</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="ch">#!/usr/bin/env python</span>
<span class="c1"># -*- coding: utf-8 -*-</span>
<span class="c1">#</span>
<span class="c1"># The MIT License (MIT)</span>
<span class="c1"># Copyright (C) 2018  Seeed Technology Co.,Ltd.</span>
<span class="c1">#</span>
<span class="c1"># This is the library for Grove Base Hat</span>
<span class="c1"># which used to connect grove sensors for Raspberry Pi.</span>
<span class="sd">&#39;&#39;&#39;</span>
<span class="sd">This is the code for</span>
<span class="sd">    - `Grove - 2.5A DC current sensor  &lt;https://www.seeedstudio.com/Grove-2-5A-DC-Current-Sensor-ACS70331-p-2929.html&gt;`_</span>
<span class="sd">    - `Grove - 5A AC/DC current sensor &lt;https://www.seeedstudio.com/Grove-5A-DC-AC-Current-Sensor-ACS70331-p-2928.html&gt;`_</span>
<span class="sd">    - `Grove - 10A current sensor      &lt;https://www.seeedstudio.com/Grove-10A-DC-Current-Sensor-ACS725-p-2927.html&gt;`_</span>
<span class="sd">Examples:</span>
<span class="sd">    .. code-block:: python</span>
<span class="sd">        import time</span>
<span class="sd">        from grove_current_sensor import Current</span>
<span class="sd">        pin = 0</span>
<span class="sd">        sensor_type = &quot;2.5A&quot;</span>
<span class="sd">        #if use 10A current sensor input: pin = 0 , sensor_type = &quot;10A&quot;</span>
<span class="sd">        if (sensor_type == &quot;2.5A&quot;):</span>
<span class="sd">            sensitivity = 1000.0 / 800.0</span>
<span class="sd">            Vref = 260</span>
<span class="sd">        if (sensor_type == &quot;5A_DC&quot;):</span>
<span class="sd">            sensitivity = 1000.0 / 200.0</span>
<span class="sd">            Vref = 1498</span>
<span class="sd">        if (sensor_type == &quot;5A_AC&quot;):</span>
<span class="sd">            sensitivity = 1000.0 / 200.0</span>
<span class="sd">            Vref = 1498</span>
<span class="sd">        if (sensor_type == &quot;10A&quot;):</span>
<span class="sd">            sensitivity = 1000.0 / 264.0</span>
<span class="sd">            Vref = 322</span>
<span class="sd">        averageValue = 500</span>
<span class="sd">        ADC = Current()</span>
<span class="sd">        while True:</span>
<span class="sd">            if(sensor_type == &quot;5A_AC&quot;):</span>
<span class="sd">                pin_voltage = ADC.get_nchan_vol_milli_data(pin,averageValue)</span>
<span class="sd">                current = ADC.get_nchan_AC_current_data(pin,sensitivity,Vref,averageValue)</span>
<span class="sd">            else:</span>
<span class="sd">                temp = ADC.get_nchan_current_data(pin,sensitivity,Vref,averageValue)</span>
<span class="sd">                current = temp[0]</span>
<span class="sd">                pin_voltage = temp[1]</span>

<span class="sd">            current = round(current)</span>
<span class="sd">            print(&quot;pin_voltage(mV):&quot;)</span>
<span class="sd">            print(pin_voltage)</span>
<span class="sd">            print(&quot;current(mA):&quot;)</span>
<span class="sd">            print(current)</span>
<span class="sd">            print()</span>
<span class="sd">            time.sleep(1)</span>

<span class="sd">&#39;&#39;&#39;</span>

<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">time</span>
<span class="kn">from</span> <span class="nn">grove.i2c</span> <span class="kn">import</span> <span class="n">Bus</span>

<span class="n">ADC_DEFAULT_IIC_ADDR</span> <span class="o">=</span> <span class="mh">0X04</span>

<span class="n">ADC_CHAN_NUM</span> <span class="o">=</span> <span class="mi">8</span>

<span class="n">REG_RAW_DATA_START</span> <span class="o">=</span> <span class="mh">0X10</span>
<span class="n">REG_VOL_START</span> <span class="o">=</span> <span class="mh">0X20</span>
<span class="n">REG_RTO_START</span> <span class="o">=</span> <span class="mh">0X30</span>

<span class="n">REG_SET_ADDR</span> <span class="o">=</span> <span class="mh">0XC0</span>

<span class="n">__all__</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Current&#39;</span><span class="p">,</span><span class="s1">&#39;Bus&#39;</span><span class="p">]</span>

<span class="k">class</span> <span class="nc">Current</span><span class="p">():</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Grove Current Sensor class</span>
<span class="sd">    &#39;&#39;&#39;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">bus_num</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">addr</span><span class="o">=</span><span class="n">ADC_DEFAULT_IIC_ADDR</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Init iic.</span>
<span class="sd">        Args: </span>
<span class="sd">            bus_num(int): the bus number;</span>
<span class="sd">            addr(int): iic address;</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">bus</span> <span class="o">=</span> <span class="n">Bus</span><span class="p">(</span><span class="n">bus_num</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">addr</span> <span class="o">=</span> <span class="n">addr</span>

    <span class="k">def</span> <span class="nf">get_nchan_vol_milli_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">n</span><span class="p">,</span><span class="n">averageValue</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Get n chanel data with unit mV.</span>
<span class="sd">        :param int n: the adc pin.</span>
<span class="sd">        :param int averageValue: Average acquisition frequency.</span>
<span class="sd">        Returns: </span>
<span class="sd">            int: voltage value</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="n">val</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">averageValue</span><span class="p">):</span>
            <span class="n">data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">bus</span><span class="o">.</span><span class="n">read_i2c_block_data</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">addr</span><span class="p">,</span><span class="n">REG_VOL_START</span><span class="o">+</span><span class="n">n</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
            <span class="n">val</span> <span class="o">+=</span> <span class="n">data</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">&lt;&lt;</span><span class="mi">8</span><span class="o">|</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">val</span> <span class="o">=</span> <span class="n">val</span> <span class="o">/</span> <span class="n">averageValue</span>
        <span class="k">return</span> <span class="n">val</span>

    <span class="k">def</span> <span class="nf">get_nchan_current_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">n</span><span class="p">,</span><span class="n">sensitivity</span><span class="p">,</span><span class="n">Vref</span><span class="p">,</span><span class="n">averageValue</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        2.5A/5A DC/10A cunrrent sensor get n chanel data with unit mA.</span>
<span class="sd">        :param int n: the adc pin.</span>
<span class="sd">        :param float sensitivity: The coefficient by which voltage is converted into current.</span>
<span class="sd">        :param int Vref: Initial voltage at no load.</span>
<span class="sd">        :param int averageValue: Average acquisition frequency.</span>
<span class="sd">        Returns: </span>
<span class="sd">            int: current value</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="n">val</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">averageValue</span><span class="p">):</span>
            <span class="n">data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">bus</span><span class="o">.</span><span class="n">read_i2c_block_data</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">addr</span><span class="p">,</span><span class="n">REG_VOL_START</span><span class="o">+</span><span class="n">n</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
            <span class="n">val</span> <span class="o">+=</span> <span class="n">data</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">&lt;&lt;</span><span class="mi">8</span><span class="o">|</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">val</span> <span class="o">=</span> <span class="n">val</span> <span class="o">/</span> <span class="n">averageValue</span>
        <span class="n">currentVal</span> <span class="o">=</span> <span class="p">(</span><span class="n">val</span> <span class="o">-</span> <span class="n">Vref</span><span class="p">)</span> <span class="o">*</span> <span class="n">sensitivity</span>
        <span class="k">return</span> <span class="n">currentVal</span><span class="p">,</span><span class="n">val</span>

    <span class="k">def</span> <span class="nf">get_nchan_AC_current_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">n</span><span class="p">,</span><span class="n">sensitivity</span><span class="p">,</span><span class="n">Vref</span><span class="p">,</span><span class="n">averageValue</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        5A current sensor AC output and get n chanel data with unit mA.</span>
<span class="sd">        :param int n: the adc pin.</span>
<span class="sd">        :param float sensitivity: The coefficient by which voltage is converted into current.</span>
<span class="sd">        :param int Vref: Initial voltage at no load.</span>
<span class="sd">        :param int averageValue: Average acquisition frequency.</span>
<span class="sd">        Returns: </span>
<span class="sd">            int: current value</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="n">sensorValue</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">averageValue</span><span class="p">):</span>
            <span class="n">data</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">bus</span><span class="o">.</span><span class="n">read_i2c_block_data</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">addr</span><span class="p">,</span><span class="n">REG_VOL_START</span><span class="o">+</span><span class="n">n</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
            <span class="n">val</span><span class="o">=</span><span class="n">data</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">&lt;&lt;</span><span class="mi">8</span><span class="o">|</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="k">if</span><span class="p">(</span><span class="n">val</span> <span class="o">&gt;</span> <span class="n">sensorValue</span><span class="p">):</span>
                <span class="n">sensorValue</span><span class="o">=</span><span class="n">val</span>
            <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.00004</span><span class="p">)</span>
        <span class="n">currentVal</span> <span class="o">=</span> <span class="p">((</span><span class="n">sensorValue</span> <span class="o">-</span> <span class="n">Vref</span><span class="p">)</span> <span class="o">*</span> <span class="n">sensitivity</span><span class="p">)</span><span class="o">*</span><span class="mf">0.707</span>
        <span class="k">return</span> <span class="n">currentVal</span>   

<span class="n">ADC</span> <span class="o">=</span> <span class="n">Current</span><span class="p">()</span>
<span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
    <span class="k">if</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">)</span> <span class="o">==</span> <span class="mi">3</span><span class="p">):</span>

        <span class="n">pin</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
        <span class="n">sensor_type</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">pin</span> <span class="o">&lt;</span> <span class="mi">8</span> <span class="ow">and</span> <span class="p">(</span><span class="n">sensor_type</span> <span class="o">==</span> <span class="s2">&quot;2.5A&quot;</span> <span class="ow">or</span> <span class="n">sensor_type</span> <span class="o">==</span> <span class="s2">&quot;5A_DC&quot;</span> <span class="ow">or</span> <span class="n">sensor_type</span> <span class="o">==</span> <span class="s2">&quot;5A_AC&quot;</span> <span class="ow">or</span> <span class="n">sensor_type</span> <span class="o">==</span> <span class="s2">&quot;10A&quot;</span><span class="p">)</span> <span class="p">):</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">sensor_type</span> <span class="o">==</span> <span class="s2">&quot;2.5A&quot;</span><span class="p">):</span>
                <span class="n">sensitivity</span> <span class="o">=</span> <span class="mf">1000.0</span> <span class="o">/</span> <span class="mf">800.0</span>
                <span class="n">Vref</span> <span class="o">=</span> <span class="mi">260</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">sensor_type</span> <span class="o">==</span> <span class="s2">&quot;5A_DC&quot;</span><span class="p">):</span>
                <span class="n">sensitivity</span> <span class="o">=</span> <span class="mf">1000.0</span> <span class="o">/</span> <span class="mf">200.0</span>
                <span class="n">Vref</span> <span class="o">=</span> <span class="mi">1498</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">sensor_type</span> <span class="o">==</span> <span class="s2">&quot;5A_AC&quot;</span><span class="p">):</span>
                <span class="n">sensitivity</span> <span class="o">=</span> <span class="mf">1000.0</span> <span class="o">/</span> <span class="mf">200.0</span>
                <span class="n">Vref</span> <span class="o">=</span> <span class="mi">1498</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">sensor_type</span> <span class="o">==</span> <span class="s2">&quot;10A&quot;</span><span class="p">):</span>
                <span class="n">sensitivity</span> <span class="o">=</span> <span class="mf">1000.0</span> <span class="o">/</span> <span class="mf">264.0</span>
                <span class="n">Vref</span> <span class="o">=</span> <span class="mi">322</span>
            <span class="n">averageValue</span> <span class="o">=</span> <span class="mi">500</span>

            <span class="k">while</span> <span class="bp">True</span><span class="p">:</span>

                <span class="k">if</span><span class="p">(</span><span class="n">sensor_type</span> <span class="o">==</span> <span class="s2">&quot;5A_AC&quot;</span><span class="p">):</span>
                    <span class="n">pin_voltage</span> <span class="o">=</span> <span class="n">ADC</span><span class="o">.</span><span class="n">get_nchan_vol_milli_data</span><span class="p">(</span><span class="n">pin</span><span class="p">,</span><span class="n">averageValue</span><span class="p">)</span>
                    <span class="n">current</span> <span class="o">=</span> <span class="n">ADC</span><span class="o">.</span><span class="n">get_nchan_AC_current_data</span><span class="p">(</span><span class="n">pin</span><span class="p">,</span><span class="n">sensitivity</span><span class="p">,</span><span class="n">Vref</span><span class="p">,</span><span class="n">averageValue</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">temp</span> <span class="o">=</span> <span class="n">ADC</span><span class="o">.</span><span class="n">get_nchan_current_data</span><span class="p">(</span><span class="n">pin</span><span class="p">,</span><span class="n">sensitivity</span><span class="p">,</span><span class="n">Vref</span><span class="p">,</span><span class="n">averageValue</span><span class="p">)</span>
                    <span class="n">current</span> <span class="o">=</span> <span class="n">temp</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                    <span class="n">pin_voltage</span> <span class="o">=</span> <span class="n">temp</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

                <span class="n">current</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="n">current</span><span class="p">)</span>
                <span class="k">print</span><span class="p">(</span><span class="s2">&quot;pin_voltage(mV):&quot;</span><span class="p">)</span>
                <span class="k">print</span><span class="p">(</span><span class="n">pin_voltage</span><span class="p">)</span>
                <span class="k">print</span><span class="p">(</span><span class="s2">&quot;current(mA):&quot;</span><span class="p">)</span>
                <span class="k">print</span><span class="p">(</span><span class="n">current</span><span class="p">)</span>
                <span class="k">print</span><span class="p">()</span>
                <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="k">print</span><span class="p">(</span><span class="s2">&quot;parameter input error!&quot;</span><span class="p">)</span>
            <span class="k">print</span><span class="p">(</span><span class="s2">&quot;Please enter parameters for example: python grove_current_sensor 0 2.5A&quot;</span><span class="p">)</span>
            <span class="k">print</span><span class="p">(</span><span class="s2">&quot;parameter1: 0-7&quot;</span><span class="p">)</span>
            <span class="k">print</span><span class="p">(</span><span class="s2">&quot;parameter2: 2.5A/5A_DC/5A_AC/10A&quot;</span><span class="p">)</span>

    <span class="k">else</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="s2">&quot;Please enter parameters for example: python grove_current_sensor 0 2.5A&quot;</span><span class="p">)</span>
        <span class="k">print</span><span class="p">(</span><span class="s2">&quot;parameter1: 0-7&quot;</span><span class="p">)</span>
        <span class="k">print</span><span class="p">(</span><span class="s2">&quot;parameter2: 2.5A/5A_DC/5A_AC/10A&quot;</span><span class="p">)</span>


<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="n">main</span><span class="p">()</span>
</pre></div>
</td></tr></table>

<p>You can modify the <strong>Vref</strong> at line 147 of the code block above:</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14</pre></div></td><td class="code"><div class="codehilite"><pre><span></span>        <span class="k">if</span> <span class="p">(</span><span class="n">pin</span> <span class="o">&lt;</span> <span class="mi">8</span> <span class="ow">and</span> <span class="p">(</span><span class="n">sensor_type</span> <span class="o">==</span> <span class="s2">&quot;2.5A&quot;</span> <span class="ow">or</span> <span class="n">sensor_type</span> <span class="o">==</span> <span class="s2">&quot;5A_DC&quot;</span> <span class="ow">or</span> <span class="n">sensor_type</span> <span class="o">==</span> <span class="s2">&quot;5A_AC&quot;</span> <span class="ow">or</span> <span class="n">sensor_type</span> <span class="o">==</span> <span class="s2">&quot;10A&quot;</span><span class="p">)</span> <span class="p">):</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">sensor_type</span> <span class="o">==</span> <span class="s2">&quot;2.5A&quot;</span><span class="p">):</span>
                <span class="n">sensitivity</span> <span class="o">=</span> <span class="mf">1000.0</span> <span class="o">/</span> <span class="mf">800.0</span>
                <span class="n">Vref</span> <span class="o">=</span> <span class="mi">260</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">sensor_type</span> <span class="o">==</span> <span class="s2">&quot;5A_DC&quot;</span><span class="p">):</span>
                <span class="n">sensitivity</span> <span class="o">=</span> <span class="mf">1000.0</span> <span class="o">/</span> <span class="mf">200.0</span>
                <span class="n">Vref</span> <span class="o">=</span> <span class="mi">1498</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">sensor_type</span> <span class="o">==</span> <span class="s2">&quot;5A_AC&quot;</span><span class="p">):</span>
                <span class="n">sensitivity</span> <span class="o">=</span> <span class="mf">1000.0</span> <span class="o">/</span> <span class="mf">200.0</span>
                <span class="n">Vref</span> <span class="o">=</span> <span class="mi">1498</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">sensor_type</span> <span class="o">==</span> <span class="s2">&quot;10A&quot;</span><span class="p">):</span>
                <span class="n">sensitivity</span> <span class="o">=</span> <span class="mf">1000.0</span> <span class="o">/</span> <span class="mf">264.0</span>
                <span class="n">Vref</span> <span class="o">=</span> <span class="mi">322</span>
            <span class="n">averageValue</span> <span class="o">=</span> <span class="mi">500</span>
</pre></div>
</td></tr></table>

<p>As you can see, for the 2.5A Current Sensor the default <strong>Vref</strong> is 260, and in the <strong>Step 3</strong>, we can find it when there is no current the zero offset value is 270mV. So let's change it into 270.</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3</pre></div></td><td class="code"><div class="codehilite"><pre><span></span>            <span class="k">if</span> <span class="p">(</span><span class="n">sensor_type</span> <span class="o">==</span> <span class="s2">&quot;2.5A&quot;</span><span class="p">):</span>
                <span class="n">sensitivity</span> <span class="o">=</span> <span class="mf">1000.0</span> <span class="o">/</span> <span class="mf">800.0</span>
                <span class="n">Vref</span> <span class="o">=</span> <span class="mi">270</span>
</pre></div>
</td></tr></table>

<p>Now, let's run this demo again.</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="n">pi</span><span class="nd">@raspberrypi</span><span class="p">:</span><span class="o">~/</span><span class="n">grove</span><span class="o">.</span><span class="n">py</span><span class="o">/</span><span class="n">grove</span> <span class="err">$</span> <span class="n">python</span> <span class="n">grove_current_sensor</span><span class="o">.</span><span class="n">py</span> <span class="mi">0</span> <span class="mf">2.5</span><span class="n">A</span>
<span class="n">pin_voltage</span><span class="p">(</span><span class="n">mV</span><span class="p">):</span>
<span class="mi">269</span>
<span class="n">current</span><span class="p">(</span><span class="n">mA</span><span class="p">):</span>
<span class="o">-</span><span class="mf">1.0</span>
<span class="p">()</span>
<span class="n">pin_voltage</span><span class="p">(</span><span class="n">mV</span><span class="p">):</span>
<span class="mi">270</span>
<span class="n">current</span><span class="p">(</span><span class="n">mA</span><span class="p">):</span>
<span class="mf">0.0</span>
<span class="p">()</span>
<span class="n">pin_voltage</span><span class="p">(</span><span class="n">mV</span><span class="p">):</span>
<span class="mi">270</span>
<span class="n">current</span><span class="p">(</span><span class="n">mA</span><span class="p">):</span>
<span class="mf">0.0</span>
<span class="p">()</span>
<span class="n">pin_voltage</span><span class="p">(</span><span class="n">mV</span><span class="p">):</span>
<span class="mi">270</span>
<span class="n">current</span><span class="p">(</span><span class="n">mA</span><span class="p">):</span>
<span class="mf">0.0</span>
<span class="p">()</span>
<span class="n">pin_voltage</span><span class="p">(</span><span class="n">mV</span><span class="p">):</span>
<span class="mi">270</span>
<span class="n">current</span><span class="p">(</span><span class="n">mA</span><span class="p">):</span>
<span class="mf">0.0</span>
<span class="p">()</span>
<span class="o">^</span><span class="n">CTraceback</span> <span class="p">(</span><span class="n">most</span> <span class="n">recent</span> <span class="n">call</span> <span class="n">last</span><span class="p">):</span>
  <span class="n">File</span> <span class="s2">&quot;grove_current_sensor.py&quot;</span><span class="p">,</span> <span class="n">line</span> <span class="mi">200</span><span class="p">,</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
    <span class="n">main</span><span class="p">()</span>
  <span class="n">File</span> <span class="s2">&quot;grove_current_sensor.py&quot;</span><span class="p">,</span> <span class="n">line</span> <span class="mi">185</span><span class="p">,</span> <span class="ow">in</span> <span class="n">main</span>
    <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="ne">KeyboardInterrupt</span>
</pre></div>
</td></tr></table>

<p>Well, better than before, now you can measure the current more accurately 😄</p>
<h2 id="faq">FAQ<a class="headerlink" href="#faq" title="Permanent link">&para;</a></h2>
<p><strong>Q1#</strong> What's the current calculation formula?</p>
<p><strong>A1:</strong> If you think the <a href="#working-principle">principle part</a> is very complicated, let's put it in a easy way. The current in the circuit to be tested excites the magnetic field, which causes the resistance value of the GMR elements change. And the resistance change  in the bridge causes a change in the voltage at the output of the chip. We call the voltage output as <strong>V<sub>IOUT</sub></strong>.</p>
<div>
<div class="MathJax_Preview">
V_{IOUT} = Sens × I_P + V_{IOUT(Q)}
</div>
<script type="math/tex; mode=display">
V_{IOUT} = Sens × I_P + V_{IOUT(Q)}
</script>
</div>
<blockquote>
<p><strong>Sens</strong>: Sens is the coefficient that converts the current into an output voltage. For this module it is 800mA/V.<br />
<strong>I<sub>p</sub></strong>: I<sub>p</sub> is the current value in the circuit to be tested, Unit mA.<br />
<strong>V<sub>IOUT(Q)</sub></strong>: V<sub>IOUT(Q)</sub> is the voltage output when the I<sub>p</sub> is 0mA(which means there is no current in the circuit to be tested), Unit mV.</p>
</blockquote>
<p>Here comes the current value:  </p>
<div>
<div class="MathJax_Preview">
I_P = {V_{IOUT} - V_{IOUT(Q)} \over Sens}
</div>
<script type="math/tex; mode=display">
I_P = {V_{IOUT} - V_{IOUT(Q)} \over Sens}
</script>
</div>
<p>Now, Let's review the figure 5, we will explain why the current value of the output is not 0 when the actual current value in the circuit to be tested is 0.  As you can see in the figure 5, the <strong>initialValue</strong> is 283.20mV, which is the <strong>V<sub>IOUT</sub></strong>; the current is 22.75mA, which is the <strong>I<sub>p</sub></strong>. As for the <strong>V<sub>IOUT(Q)</sub></strong>, it is the <strong>Vref</strong> we set in the code.
In figure 5, it is 265. And the <strong>Sens</strong> is 800mA/V, which is 800mA/1000mV. Now, just do some math:</p>
<div>
<div class="MathJax_Preview">
{283.20mV-265mV \over 800mA/1000mV} = 22.75mA
</div>
<script type="math/tex; mode=display">
{283.20mV-265mV \over 800mA/1000mV} = 22.75mA
</script>
</div>
<p>So, in the figure 6, when we set the <strong>Vref</strong> to 283.20, the <strong>Ip</strong> turns to 0mA.</p>
<h2 id="resources">Resources<a class="headerlink" href="#resources" title="Permanent link">&para;</a></h2>
<ul>
<li><strong>[ZIP]</strong> <a href="https://github.com/SeeedDocument/Grove-2.5A_DC_Current_Sensor-ACS70331/raw/master/res/Grove - 2.5A DC Current Sensor(ACS70331).zip">Grove - 2.5A DC Current Sensor(ACS70331) Schematic file</a></li>
<li><strong>[PDF]</strong> <a href="https://github.com/SeeedDocument/Grove-2.5A_DC_Current_Sensor-ACS70331/raw/master/res/Current_Sensor_ACS70331.pdf">ACS70331 Datasheet</a></li>
</ul>
<h2 id="tech-support">Tech Support<a class="headerlink" href="#tech-support" title="Permanent link">&para;</a></h2>
<p>Please submit any technical issue into our <a href="http://forum.seeedstudio.com/">forum</a> or drop mail to <a href="&#109;&#97;&#105;&#108;&#116;&#111;&#58;&#116;&#101;&#99;&#104;&#115;&#117;&#112;&#112;&#111;&#114;&#116;&#64;&#115;&#101;&#101;&#101;&#100;&#46;&#99;&#99;">&#116;&#101;&#99;&#104;&#115;&#117;&#112;&#112;&#111;&#114;&#116;&#64;&#115;&#101;&#101;&#101;&#100;&#46;&#99;&#99;</a></p>
                
                  
                
              
              
                
              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
        
          <a href="../Grove-RS485/index.html" title="Grove-RS485" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
            </div>
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                Grove-RS485
              </span>
            </div>
          </a>
        
        
          <a href="../Grove-5A_DC_AC_Current_Sensor-ACS70331/index.html" title="Grove-5A_DC_AC_Current_Sensor-ACS70331" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                Grove-5A_DC_AC_Current_Sensor-ACS70331
              </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
          <div class="md-footer-copyright__highlight">
            Seeedstudio 2018
          </div>
        
        powered by
        <a href="http://www.mkdocs.org/" title="MkDocs">MkDocs</a>
        and
        <a href="http://squidfunk.github.io/mkdocs-material/" title="Material for MkDocs">
          Material for MkDocs</a>
      </div>
      
        
  <div class="md-footer-social">
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    
      <a href="https://www.facebook.com/seeedstudiosz/" class="md-footer-social__link fa fa-facebook"></a>
    
      <a href="https://github.com/SeeedDocument" class="md-footer-social__link fa fa-github-alt"></a>
    
  </div>

      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../assets/javascripts/application-c35428f87f.js"></script>
      
      
      <script>app.initialize({url:{base:".."}})</script>
      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-MML-AM_CHTML"></script>
      
    
    
      
      <script>!function(e,t,a,n,o,c,i){e.GoogleAnalyticsObject=o,e[o]=e[o]||function(){(e[o].q=e[o].q||[]).push(arguments)},e[o].l=1*new Date,c=t.createElement(a),i=t.getElementsByTagName(a)[0],c.async=1,c.src=n,i.parentNode.insertBefore(c,i)}(window,document,"script","https://www.google-analytics.com/analytics.js","ga"),ga("create","UA-115878881-1","auto"),ga("set","anonymizeIp",!0),ga("send","pageview");var links=document.getElementsByTagName("a");Array.prototype.map.call(links,function(e){e.host!=document.location.host&&e.addEventListener("click",function(){var t=e.getAttribute("data-md-action")||"follow";ga("send","event","outbound",t,e.href)})});var query=document.forms.search.query;query.addEventListener("blur",function(){if(this.value){var e=document.location.pathname;ga("send","pageview",e+"?q="+this.value)}})</script>
      
    
  </body>

<!-- Mirrored from wiki.seeedstudio.com/Grove-2.5A-DC-Current-Sensor-ACS70331/ by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 18 Apr 2019 20:55:25 GMT -->
</html>