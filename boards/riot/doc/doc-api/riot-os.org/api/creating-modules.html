<!DOCTYPE html>
<html lang="en">
  
<!-- Mirrored from riot-os.org/api/creating-modules.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 23 May 2019 16:29:03 GMT -->
<head>
    <link rel="icon" type="image/png" href="favicon.png">
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
    <title>Creating modules</title>
    <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
    <script src="jquery.min.js"></script>
    <script src="jquery.powertip.min.js"></script>
    <script src="jquery-ui.min.js"></script>
    <script src="doxy-jquery.js"></script>
    <script src="dynsections.js"></script>
    <link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
    <link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
    <!-- Bootstrap -->
    <link href="doxygen.css" rel="stylesheet">
    <link href="fonts.css" rel="stylesheet">
    <link href="bootstrap.min.css" rel="stylesheet">
    <link href="jquery.smartmenus.bootstrap.css" rel="stylesheet">
    <link href="riot.css" rel="stylesheet">
    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
  </head>
  <body>
      <div id="top">
        <nav class="navbar navbar-inverse">
          <div class="container-fluid">
            <!-- Brand and toggle get grouped for better mobile display -->
            <div class="navbar-header">
              <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar-collapse" aria-expanded="false">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
              </button>
              <a class="navbar-brand" id="brand-logo" href="http://riot-os.org/"><img height="40px" src="riot-logo.svg" /></a>
              <p class="navbar-text text-center visible-xs">Documentation</p>
            </div>
            <!-- Collect the nav links, forms, and other content for toggling -->
            <div class="collapse navbar-collapse" id="navbar-collapse">
              <p class="navbar-text navbar-left"><span id="projectbrief">The friendly Operating System for the Internet of Things</span></p>
              <ul id="riot-navlist" class="nav navbar-nav"></ul>
              <form id="riot-searchform" class="navbar-form navbar-left navbar-right hidden-sm hidden-xs">
                 <div class="form-group">
                   <div id="MSearchBox" class="MSearchBoxActive">
                     <div class="input-group">
                       <div class="input-group-addon">
                         <span id="MSearchSelect" class="glyphicon glyphicon-search" aria-hidden="true" onmouseover="return searchBox.OnSearchSelectShow()" onmouseout="return searchBox.OnSearchSelectHide()"></span>
                       </div>
                       <input class="form-control" type="text" id="MSearchField" placeholder="Search" accesskey="S" onfocus="searchBox.OnSearchFieldFocus(true)" onblur="searchBox.OnSearchFieldFocus(false)" onkeyup="searchBox.OnSearchFieldChange(event)">
                       <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()">
                         <span id="search-reset" class="glyphicon glyphicon-remove-circle" aria-hidden="true"></span>
                       </a>
                     </div>
                   </div>
                 </div>
              </form>
            </div><!-- /.navbar-collapse -->
          </div><!-- /.container-fluid -->
        </nav>
      </div>
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.html','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('creating-modules.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">Creating modules </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>Modules in RIOT are well-defined units of code that provide a set of features to your application. This includes also drivers and to a certain extent ports for CPUs and boards (with some exceptions, see the porting guide for further information).</p>
<h1><a class="anchor" id="the-general-structure"></a>
The general structure                                  </h1>
<p>Like <a class="el" href="creating-an-application.html">applications</a>, modules are directories containing source files and a Makefile. Additionally their API can be defined in one or more header files, residing in the include path of their super-module.</p>
<p>E.g. the <a class="el" href="group__sys__shell.html">Shell</a> module is implemented in <code>sys/shell</code> and defines its API in <code><a class="el" href="shell_8h.html" title="Shell interface definition. ">sys/include/shell.h</a></code> and the <a class="el" href="group__drivers__isl29020.html">ISL29020 light sensor</a> driver is implemented in <code>drivers/isl29020</code> and defines its API in <code><a class="el" href="isl29020_8h.html" title="Device driver interface for the ISL29020 light sensor. ">drivers/include/isl29020.h</a></code>.</p>
<p>A module's Makefile just needs to include <code>Makefile.base</code> in the RIOT repository:</p>
<div class="fragment"><div class="line">include $(RIOTBASE)/Makefile.base</div></div><!-- fragment --><p>If your module's name differs from the name of the directory it resides in you need to set the <code>MODULE</code> macro in addition.</p>
<p>When compiled a module always provides a <code>MODULE_&lt;MODULENAME&gt;</code> macro to the system. This way, other modules can check if the module is available in the current configuration or not.</p>
<p>Modules can be used by adding their name to the <code>USEMODULE</code> macro of your application's Makefile.</p>
<h3>Pitfalls</h3>
<p>The <code>MODULE</code> name should be unique or build breaks as modules overwrite the same output file. This might for example lead to <code>undefined reference to</code> errors in the linker which can be hard to track down.</p>
<p>This problem happened in the past for:</p>
<ul>
<li>Packages root directory (libfixmath/u8g2)</li>
<li>boards/cpu/periph and their common boards/cpu/periph</li>
</ul>
<p>Note: even if all boards and cpus implement the <code>board</code> and <code>cpu</code> modules, only one is used in an application so there is no conflict.</p>
<h1>Module dependencies </h1>
<p>Your module may depend on other modules to minimize code duplication. These dependencies are defined in <code>Makefile.dep</code> with the following syntax:</p>
<div class="fragment"><div class="line">ifneq (,$(filter your_module,$(USEMODULE))) # if module in USEMODULE</div><div class="line">  USEMODULE += dep1                         # add dependencies to USEMODULE</div><div class="line">  USEMODULE += dep2</div><div class="line">endif</div></div><!-- fragment --><p>Note, that <code>Makefile.dep</code> is processed only once so you have to take care to add the dependency block for your module <em>before</em> your dependencies pull in their dependencies.</p>
<h1><a class="anchor" id="modules-outside-of-riotbase"></a>
Modules outside of RIOTBASE                      </h1>
<p>Modules can be defined outside <code>RIOTBASE</code>. In addition to add it to <code>USEMODULE</code> the user needs to add the module path to <code>EXTERNAL_MODULE_DIRS</code>.</p>
<p>The external module can optionally define the following files:</p><ul>
<li><code>Makefile.include</code> file to set global build configuration like <code>CFLAGS</code> or add API headers include paths to the <code>USEMODULE_INCLUDES</code> variable.</li>
<li><code>Makefile.dep</code> file to set module dependencies</li>
</ul>
<p>An example can be found in <a href="https://github.com/RIOT-OS/RIOT/tree/master/tests/external_module_dirs"><code>tests/external_module_dirs</code></a></p>
<h1><a class="anchor" id="pseudomodules"></a>
Pseudomodules                                                  </h1>
<p>Pseudomodules are modules that do not have any code. Their main use cases are to provide base information for dependencies to other modules or information to the code base via the <code>MODULE_&lt;MODULENAME&gt;</code> macro. Pseudomodules can provide header files too, if need be. To create a pseudomodule just add its name to the <code>PSEUDOMODULES</code> macro in <code>Makefile.pseudomodules</code>. </p>
</div></div><!-- contents -->
</div><!-- doc-content -->
    <div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
        <ul>
            <li class="footer">Generated on Thu May 23 2019 18:00:20 by <a href="http://www.doxygen.org/index.html">
                       <img class="footer" src="doxygen.png" alt="doxygen"></a> 1.8.13</li>
        </ul>
    </div>
    <!-- Include all compiled plugins (below), or include individual files as needed -->
    <script src="bootstrap.min.js"></script>
    <script src="jquery.smartmenus.min.js"></script>
    <script src="jquery.smartmenus.bootstrap.min.js"></script>
    <script src="riot-doxy.js"></script>
  </body>

<!-- Mirrored from riot-os.org/api/creating-modules.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 23 May 2019 16:29:04 GMT -->
</html>
